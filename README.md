This ended up being way slower than I expected. Sad.
